% load rain
% refmaskTOT=ref2mask;
% refmaskTOTKST(:,1:270)=refmaskTOT(:,451:720);
% refmaskTOTKST(:,271:720)=refmaskTOT(:,1:450);
% for i=1:24
% for hi=1:50
% data=refmaskTOTKST;
% instmat=data((hi-1)*20+1:hi*20,(i-1)*30+1:i*30);
% refmaskTOTKST_24(hi,i+1)=mean(instmat(~isnan(instmat)));
% clear data instmat
% end
% end
% refmaskTOTKST_24(:,1)=refmaskTOTKST_24(:,25);
% refmaskTOTKST_24(:,26)=refmaskTOTKST_24(:,2);
% save('rain','-append')
% load norain
% refmaskTOT=ref2mask;
% refmaskTOTKST(:,1:270)=refmaskTOT(:,451:720);
% refmaskTOTKST(:,271:720)=refmaskTOT(:,1:450);
% for i=1:24
% for hi=1:50
% data=refmaskTOTKST;
% instmat=data((hi-1)*20+1:hi*20,(i-1)*30+1:i*30);
% refmaskTOTKST_24(hi,i+1)=mean(instmat(~isnan(instmat)));
% clear data instmat
% end
% end
% refmaskTOTKST_24(:,1)=refmaskTOTKST_24(:,25);
% refmaskTOTKST_24(:,26)=refmaskTOTKST_24(:,2);
% save('norain','-append')
% load rainsys
% refmaskTOT=ref2mask;
% refmaskTOTKST(:,1:270)=refmaskTOT(:,451:720);
% refmaskTOTKST(:,271:720)=refmaskTOT(:,1:450);
% for i=1:24
% for hi=1:50
% data=refmaskTOTKST;
% instmat=data((hi-1)*20+1:hi*20,(i-1)*30+1:i*30);
% refmaskTOTKST_24(hi,i+1)=mean(instmat(~isnan(instmat)));
% clear data instmat
% end
% end
% refmaskTOTKST_24(:,1)=refmaskTOTKST_24(:,25);
% refmaskTOTKST_24(:,26)=refmaskTOTKST_24(:,2);
% save('rainsys','-append')
% load raincol
% refmaskTOT=ref2mask;
% refmaskTOTKST(:,1:270)=refmaskTOT(:,451:720);
% refmaskTOTKST(:,271:720)=refmaskTOT(:,1:450);
% for i=1:24
% for hi=1:50
% data=refmaskTOTKST;
% instmat=data((hi-1)*20+1:hi*20,(i-1)*30+1:i*30);
% refmaskTOTKST_24(hi,i+1)=mean(instmat(~isnan(instmat)));
% clear data instmat
% end
% end
% refmaskTOTKST_24(:,1)=refmaskTOTKST_24(:,25);
% refmaskTOTKST_24(:,26)=refmaskTOTKST_24(:,2);
% save('raincol','-append')
% load raincell
% refmaskTOT=ref2mask;
% refmaskTOTKST(:,1:270)=refmaskTOT(:,451:720);
% refmaskTOTKST(:,271:720)=refmaskTOT(:,1:450);
% for i=1:24
% for hi=1:50
% data=refmaskTOTKST;
% instmat=data((hi-1)*20+1:hi*20,(i-1)*30+1:i*30);
% refmaskTOTKST_24(hi,i+1)=mean(instmat(~isnan(instmat)));
% clear data instmat
% end
% end
% refmaskTOTKST_24(:,1)=refmaskTOTKST_24(:,25);
% refmaskTOTKST_24(:,26)=refmaskTOTKST_24(:,2);
% save('raincell','-append')
% load noraincell
% refmaskTOT=ref2mask;
% refmaskTOTKST(:,1:270)=refmaskTOT(:,451:720);
% refmaskTOTKST(:,271:720)=refmaskTOT(:,1:450);
% for i=1:24
% for hi=1:50
% data=refmaskTOTKST;
% instmat=data((hi-1)*20+1:hi*20,(i-1)*30+1:i*30);
% refmaskTOTKST_24(hi,i+1)=mean(instmat(~isnan(instmat)));
% clear data instmat
% end
% end
% refmaskTOTKST_24(:,1)=refmaskTOTKST_24(:,25);
% refmaskTOTKST_24(:,26)=refmaskTOTKST_24(:,2);
% save('noraincell','-append')
% load noraincol
% refmaskTOT=ref2mask;
% refmaskTOTKST(:,1:270)=refmaskTOT(:,451:720);
% refmaskTOTKST(:,271:720)=refmaskTOT(:,1:450);
% for i=1:24
% for hi=1:50
% data=refmaskTOTKST;
% instmat=data((hi-1)*20+1:hi*20,(i-1)*30+1:i*30);
% refmaskTOTKST_24(hi,i+1)=mean(instmat(~isnan(instmat)));
% clear data instmat
% end
% end
% refmaskTOTKST_24(:,1)=refmaskTOTKST_24(:,25);
% refmaskTOTKST_24(:,26)=refmaskTOTKST_24(:,2);
% save('noraincol','-append')
% load norainsys
% refmaskTOT=ref2mask;
% refmaskTOTKST(:,1:270)=refmaskTOT(:,451:720);
% refmaskTOTKST(:,271:720)=refmaskTOT(:,1:450);
% for i=1:24
% for hi=1:50
% data=refmaskTOTKST;
% instmat=data((hi-1)*20+1:hi*20,(i-1)*30+1:i*30);
% refmaskTOTKST_24(hi,i+1)=mean(instmat(~isnan(instmat)));
% clear data instmat
% end
% end
% refmaskTOTKST_24(:,1)=refmaskTOTKST_24(:,25);
% refmaskTOTKST_24(:,26)=refmaskTOTKST_24(:,2);
% save('norainsys','-append')
clear
load('rain','refmaskTOTKST_24','refmaskTOTKST')
rain_24=refmaskTOTKST_24;
rain=refmaskTOTKST;
clear refmaskTOTKST_24 'refmaskTOTKST'

load('rainsys','refmaskTOTKST_24','refmaskTOTKST')
rainsys_24=refmaskTOTKST_24;
rainsys=refmaskTOTKST;
clear refmaskTOTKST_24 'refmaskTOTKST'

load('norainsys','refmaskTOTKST_24','refmaskTOTKST')
norainsys_24=refmaskTOTKST_24;
norainsys=refmaskTOTKST;
clear refmaskTOTKST_24 'refmaskTOTKST'

load('raincell','refmaskTOTKST_24','refmaskTOTKST')
raincell_24=refmaskTOTKST_24;
raincell=refmaskTOTKST;
clear refmaskTOTKST_24 'refmaskTOTKST'
    h=[15:15:15000];
    t24=[-0.5:1:24.5];
    h24=[300:300:15000];
    t=[120:120:86400]/3600;

            out{1,1}.var=rain_24*100;
            out{1,2}.var=rainsys_24*100;
            out{1,3}.var=norainsys_24*100;
            out{1,4}.var=raincell_24*100;
            out{2,1}.var=rain*100;
            out{2,2}.var=rainsys*100;
            out{2,3}.var=norainsys*100;
            out{2,4}.var=raincell*100;
            contourflag=0;
            contourline=2;

                prefix_filename{1}='hourly_all';
                prefix_filename{2}='2min_all';
            for oi=1:2
                out{oi,1}.name='Total';
                out{oi,2}.name='Raining System';
                out{oi,3}.name='Non-raining System';
                out{oi,4}.name='Rain Echo';
                for oj=1:4
                    out{oi,oj}.cmin=0;
                    out{oi,oj}.cmax=20;
                    out{oi,oj}.cint=200;
                    out{oi,oj}.cbint=5;
                    out{oi,oj}.cb_name='%';
                        k=1;
                    for cti=out{oi,oj}.cmin:out{oi,oj}.cbint:out{oi,oj}.cmax
                        out{oi,oj}.cticks{k}=num2str(cti);
                        k=k+1;
                    end
                    out{1,oj}.xax=t24;
                    out{2,oj}.xax=t;
                    out{oi,oj}.xlim=[0 24];
                    out{oi,oj}.xlb='Hour (KST)';
                    out{1,oj}.yax=h24/1000;
                    out{2,oj}.yax=h/1000;
                    out{oi,oj}.ylim=[0 15];
                    out{oi,oj}.ylb='Height (km)';
                    out{oi,oj}.ctl=[10 10; 1 1];
                end
            end
Figure_make
